(this.webpackJsonpstaypoints=this.webpackJsonpstaypoints||[]).push([[0],{53:function(t,e,a){},67:function(t,e,a){"use strict";a.r(e);var n=a(3),c=a(0),r=a.n(c),s=a(16),i=a.n(s),o=(a(53),a(95)),l=a(29),j=a(9),u=a(87),d=a(30),h=a(100),b=a(88),p=a(89),m=a(90),O=a(97),x=a(91),f=a(96),g=a(38),v=a(43),M=a.n(v),y=a(28),S=a.n(y),k=a(92),w=a(98),Y=a(93),D=a(99),A=a(94);a(56);function H(){var t=r.a.useState(),e=Object(j.a)(t,2),a=e[0],c=e[1],s=r.a.useState(Math.random()),i=Object(j.a)(s,2),o=i[0],v=i[1],y=r.a.useState(!1),H=Object(j.a)(y,2),P=H[0],I=H[1],z=r.a.useState([[0,0],[0,0]]),F=Object(j.a)(z,2),W=F[0],q=F[1],E=r.a.useState(60),G=Object(j.a)(E,2),J=G[0],R=G[1],B=r.a.useState(100),L=Object(j.a)(B,2),T=L[0],U=L[1],X=r.a.useState(null),Z=Object(j.a)(X,2),K=Z[0],N=Z[1];return r.a.useEffect((function(){a&&q([[Math.min.apply(Math,Object(l.a)(a.tracks[0].points.map((function(t){return t.lat})))),Math.min.apply(Math,Object(l.a)(a.tracks[0].points.map((function(t){return t.lon}))))],[Math.max.apply(Math,Object(l.a)(a.tracks[0].points.map((function(t){return t.lat})))),Math.max.apply(Math,Object(l.a)(a.tracks[0].points.map((function(t){return t.lon}))))]])}),[a,o]),Object(n.jsxs)(u.a,{style:{padding:20},container:!0,direction:"column",justify:"flex-end",alignItems:"center",spacing:3,children:[Object(n.jsx)(u.a,{item:!0,children:Object(n.jsxs)(d.a,{variant:"body1",children:["Geospatial Data Management 2020/2021, project 1",Object(n.jsx)("br",{}),"Alfonso Adduci (mat. 908977)"]})}),Object(n.jsx)(u.a,{item:!0,children:Object(n.jsx)(d.a,{variant:"h3",children:"StayPoints"})}),Object(n.jsx)(u.a,{item:!0,children:Object(n.jsxs)(h.a,{children:[Object(n.jsx)(b.a,{title:"Load a GPX file"}),Object(n.jsx)(p.a,{children:Object(n.jsx)("input",{type:"file",accept:".gpx",onChange:function(t){try{var e=t.target.files[0],a=new FileReader;a.onload=function(t){N(null);var e=t.target.result,a=new g;a.parse(e),c(a),v(Math.random())},a.readAsText(e)}catch(t){console.log(t)}}})}),Object(n.jsx)(m.a,{})]})}),(null===a||void 0===a?void 0:a.tracks[0])&&Object(n.jsx)(u.a,{item:!0,children:Object(n.jsxs)(h.a,{children:[Object(n.jsx)(b.a,{title:"StayPoints detection"}),Object(n.jsxs)(p.a,{children:["Stops for at least"," ",Object(n.jsx)(O.a,{fullWidth:!0,value:J,onChange:function(t){N(null),R(t.target.value)},endAdornment:Object(n.jsx)(x.a,{position:"end",children:"seconds"}),type:"number",size:"small"}),Object(n.jsx)("br",{}),Object(n.jsx)("br",{}),"in a circle of radius",Object(n.jsx)(O.a,{fullWidth:!0,value:T,onChange:function(t){N(null),U(t.target.value)},endAdornment:Object(n.jsx)(x.a,{position:"end",children:"meters"}),type:"number",size:"small"})]}),Object(n.jsxs)(m.a,{children:[Object(n.jsx)(f.a,{onClick:function(t){I(!0),N(C(a.tracks[0].points,T,J)),v(Math.random()),I(!1)},startIcon:Object(n.jsx)(M.a,{}),variant:"contained",color:"primary",disabled:!!K||P||J<=0||T<=0||!1,children:"Find"}),K&&Object(n.jsxs)(d.a,{variant:"body1",children:[K.length," StayPoints found"]}),!K&&P&&Object(n.jsx)(d.a,{variant:"body1",children:"loading..."})]})]})}),(null===a||void 0===a?void 0:a.tracks[0])&&Object(n.jsx)(u.a,{item:!0,children:Object(n.jsxs)(h.a,{children:[Object(n.jsx)(b.a,{title:a.metadata.name||a.tracks[0].name||""}),Object(n.jsx)(p.a,{children:Object(n.jsxs)(k.a,{bounds:W,scrollWheelZoom:!1,whenReady:function(){},children:[Object(n.jsx)(w.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(n.jsx)(Y.a,{pathOptions:{color:"red"},positions:a.tracks.map((function(t){return t.points.map((function(t){return[t.lat,t.lon]}))}))}),K&&K.map((function(t){return Object(n.jsx)(D.a,{center:[t.lat,t.lon],radius:T,children:Object(n.jsxs)(A.a,{children:["From: ",S()(t.arv).format("YYYY/MM/DD HH:mm:ss"),Object(n.jsx)("br",{}),"Until: ",S()(t.lev).format("YYYY/MM/DD HH:mm:ss"),Object(n.jsx)("br",{}),"Stay: ",S.a.utc(S.a.duration(t.lev-t.arv).asMilliseconds()).format("H[h] m[m] s[s]")]})})}))]},o)})]})})]})}var P=function(t,e){var a=function(t){return t*Math.PI/180},n=t.latitude||t.lat,c=t.longitude||t.lng||t.lon,r=e.latitude||e.lat,s=e.longitude||e.lng||e.lon,i=a(r-n),o=a(s-c),l=Math.pow(Math.sin(i/2),2)+Math.cos(a(n))*Math.cos(a(r))*Math.pow(Math.sin(o/2),2);return 6378137*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))},C=function(t,e,a){try{for(var n=[],c=0;c<t.length;){for(var r=c+1;r<t.length;){if(P(t[c],t[r])>e){if((new Date(t[r].time)-new Date(t[c].time))/1e3>a){var s=t.slice(c,r);n.push({lat:s.map((function(t){return t.lat})).reduce((function(t,e){return t+e}),0)/s.length,lon:s.map((function(t){return t.lon})).reduce((function(t,e){return t+e}),0)/s.length,arv:s[0].time,lev:s.slice(-1)[0].time})}c=r;break}r++}r===t.length&&c!==r&&c++}return n}catch(i){return console.log(i),null}};a(65);var I=function(){return Object(n.jsx)(H,{})};i.a.render(Object(n.jsxs)(r.a.StrictMode,{children:[Object(n.jsx)(o.a,{}),Object(n.jsx)(I,{})]}),document.getElementById("root"))}},[[67,1,2]]]);
//# sourceMappingURL=main.1f5f8a4b.chunk.js.map